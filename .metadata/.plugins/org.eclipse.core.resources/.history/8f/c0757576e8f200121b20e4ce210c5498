package br.usp.ime.tcc.activities.test;

import android.test.ActivityInstrumentationTestCase2;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.SeekBar;
import br.usp.ime.tcc.activities.FilteredImageActivity;
import br.usp.ime.tcc.activities.R;
import br.usp.ime.tcc.utils.Constants;

public class FilteredImageActivityTest extends
		ActivityInstrumentationTestCase2<FilteredImageActivity> {
	private FilteredImageActivity filteredImageActivity;

	private Button saveButton;
	private Button discardButton;
	private ImageView filteredImage;
	private SeekBar intensityBar;

	public FilteredImageActivityTest() {
		super("br.usp.ime.tcc.activities", FilteredImageActivity.class);
	}

	@Override
	protected void setUp() throws Exception {
		super.setUp();

		setActivityInitialTouchMode(false);

		filteredImageActivity = getActivity();

		loadComponents();
	}

	private void loadComponents() {
		loadButtons();
		filteredImage = (ImageView) filteredImageActivity.findViewById(R.id.filtered_image);
		intensityBar = (SeekBar) filteredImageActivity.findViewById(R.id.intensity_bar);
	}

	private void loadButtons() {
		discardButton = (Button) filteredImageActivity
				.findViewById(br.usp.ime.tcc.activities.R.id.discard_button);

		saveButton = (Button) filteredImageActivity
				.findViewById(br.usp.ime.tcc.activities.R.id.save_button);
	}

	private void buttonNotNullAndResponsive(final Button button) {
		assertNotNull(button);
		
		filteredImageActivity.runOnUiThread(new Runnable() {
			@Override
			public void run() {
				assertEquals(true, button.performClick());
			}
		});
	}
	
	//Tests
	
	public void testDiscardButton() {
		buttonNotNullAndResponsive(discardButton);
	}

	public void testSaveButton() {
		buttonNotNullAndResponsive(saveButton);
	}

	public void testImageViewNotNull() {
		assertNotNull(filteredImage);
	}
	
	public void testSeekBarNotNull() {
		assertNotNull(intensityBar);
	}
	
	public void testRightSeekBarMaximum() {
		assertEquals(Constants.MAX_INTENSITY, intensityBar.getMax());
	}
	
	public void testRightSeekBarProgress() {
		assertEquals(Constants.PROGRESS, intensityBar.getProgress());
	}
}
